<p align="center">
  <img src="/assets/Food_wishes.webp" />
</p>

# PHP/MYSQL Project *(English)*

Open website at [Food Wishes](http://stevensmark.infinityfreeapp.com/index.php) <br/>

You can sign up or use the visitor's credentials below:<br/>

email: guest@foodwishes.com<br/>
Password: Password@321<br/>

If you want, you can delete your account afterwards, but you cannot delete the guest account.

## Objective
To develop a Full stack web application using an Apache server, a MySQL database and using PHP as the main programming language.<br/> 
The site allows users to sign up & share their favourite food recipes as well as comment on other peoples recipes. All the ususal CRUD operations are there & one can even upload pictures of the food. There is also a search option to quickly find recipes based on any word found in the recipe such as ingredients. The User can also send an email (with or without attachment) to the site owner. The forms contain some validation too...</br>

For this project I wanted to learn about PHP and MySQL databases to produce a full stack web application. The basis for this project comes from the OpenClassrooms course [Design your website with PHP and MySQL](https://openclassrooms.com/en/courses/918836-concevez-votre-site-web-avec-php-et-mysql) *(in french)*. I used the example in the course as a starting point...</br> 
As the course does not explain everything, I found myself completing the functionality to be able to actually send an attachment, search for items as well as form validation, for example, which are not covered in the course.</br>
The site is not very inspiring (yet another recipe website, why is Openclassrooms obsessed with recipe websites?) and the css styling is simple, but the idea behind this project was to discover new programming languages and not to produce a production ready application.

## Features
- [x] Create/Destroy an account
- [x] Login / Logout
- [x] Recipes viewing page
- [x] Create/Update/Delete a recipe
- [x] Upload/update an image
- [x] Contact Us page  
- [x] Form validation : valid input/password strength checking, existing user check etc...
- [x] File Uploading, verifying & sending by email
- [x] Search option

## Skills
- [x] Setting up the relevant front-end environment
- [x] Developing a web dynamic application using PHP
- [x] Developing web application using MySQL database
- [x] Managing site events with PHP


# Installation *(English)*

## Prerequisites

- [MAMP](https://www.mamp.info/en/downloads/older-versions/)  Version 4.2.0
- [Visual Studio Code](https://code.visualstudio.com/) or another IDE of your choice


## Installing and running the project


- Download and Install MAMP :<br/>

Once downloaded, install it. There are afew options. If you are offered to install MAMP Pro, say no, because it is a paid program and you won't need it. MAMP alone is enough.<br/>

Clone this repository onto your computer and put it in<br/>

- [x] C:MAMP/htdocs under Windows 
- [x] /Applications/MAMP/htdocs under Mac.<br/>

Note: If you decide to keep the project elsewhere, don't forget to change the server document root: <br/>
To do this: Once you've started MAMP, click on MAMP > preferences > Webserver & change document root to the relevant folder<br/>

Start MAMP which starts Apache and MySQL (you may have to click on "Start Servers"). You should see the little green LEDs at the top right of the window. This may take a little while for these programs to start.<br/>

If a window appears telling you that the firewall is blocking Apache or MySQL, click on "Allow Access" (it is normal).<br/>

Click on MAMP > preferences > PHP & change the Standard version to 7.3.7<br/>


- Install Database

When MAMP has successfully launched Apache and MySQL, click on the "Open WebStart Page" button in the middle, which allows you to open the MAMP home page in your browser.<br/>

Click Tools > phpMyAdmin : This will open a new window, giving you access to the MYSQL database. You can import the database file `we_love_food.sql` you will find in the folder `SQL` to setup the database for this project.

- Edit the following values in your `php.ini` file:<br/>

Make sure you edit the correct php.ini file for example: C:\MAMP\conf\php7.3.7<br/>
upload_max_filesize = 5M (changed this from 2M)<br/>
post_max_size = 8M (changed this from 8M)<br/>
max_execution_time = 60 (changed this from 30)<br/>
max_input_time = 120 (changed this from 60)<br/>
memory_limit = 128M (Changed this from 128M)<br/>

- Edit the following values in the`variables.php` file:<br/>

You will need to add your own details for the SMTP server: <br/>

  $SMTPUsername = 'youremail@gmail.com';    // SMTP username <br/>
  $SMTPPassword = 'generatedByGmail';       // SMTP password <br/>
  $recipientEmail = 'youremail@gmail.com'<br/>

Using Gmail, you'll need to read their documentation to get an "app password" generated by Google. As I have used Gmail the server settings are as below (see `contact_post.php`), but if you are using different email then you'll have to change here also..<br/>

  // Server settings  <br/>
  $mail->isSMTP();                            // Set mailer to use SMTP <br/>
  $mail->Host = 'smtp.gmail.com';             // Specify main and backup SMTP servers <br/>
  $mail->SMTPAuth = true;                     // Enable SMTP authentication <br/>
  $mail->Username = $SMTPUsername;            // SMTP username <br/>
  $mail->Password = $SMTPPassword;            // SMTP password <br/>
  $mail->SMTPSecure = 'ssl';                  // Enable TLS encryption, `ssl` also accepted <br/>
  $mail->Port = 465;                          // TCP port to connect to <br/>

- Run the Api:

If you've done everything correctly, then when you click on `My Website` on the MAMP home page in your browser the project should open.</br>

Enjoy<br/>

## Notes

I have used  [InfinityFree](https://www.infinityfree.net/) to host this project.
If you’re using free hosting with your own domain or a subdomain, you’ll want to make your website work over HTTPS (SSL). Fortunately, InfinityFree provides all the tools you need to make it so. Please refer to their notes on obtaining a free SSL & then you'll need to add the following code to your `.htaccess` file: <br/>
This code is NOT in my `.htaccess` file (in the repo version) so you can use the project on localhost.<br/>

RewriteEngine On<br/>
RewriteCond %{HTTP:X-Forwarded-Proto} !https<br/>
RewriteCond %{HTTPS} off<br/>
RewriteCond %{HTTP:CF-Visitor} !{"scheme":"https"}<br/>
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]<br/>

Here are the two web pages I used to do this :<br/>

- [How to get Free SSL (HTTPS) on InfinityFree](https://forum.infinityfree.net/t/how-to-get-free-ssl-https-on-infinityfree/49323)

- [How to force all traffic to HTTPS](https://forum.infinityfree.net/t/how-to-force-all-traffic-to-https/49322)


<p align="center">
  <img src="/assets/Food_wishes.webp" />
</p>

# Projet PHP/MYSQL *(français)*

Ouvrir le site web à [Food Wishes](http://stevensmark.infinityfreeapp.com/index.php) <br/>

Vous pouvez vous inscrire ou utiliser les informations d'identification du visiteur ci-dessous :<br/>

e-mail : guest@foodwishes.com<br/>
Mot de passe : Password@321<br/>

Si vous le souhaitez, vous pouvez supprimer votre compte par la suite, mais vous ne pouvez pas supprimer le compte invité.

## Objectif
Développer une application Web Full stack en utilisant un serveur Apache, une base de données MySQL et en utilisant PHP comme langage de programmation principal.<br/>
Le site permet aux utilisateurs de s'inscrire et de partager leurs recettes préférées, ainsi que de commenter les recettes des autres. Toutes les opérations CRUD habituelles sont présentes et il est même possible de télécharger des photos des plats. Il y a aussi une option de recherche pour trouver rapidement des recettes à partir de n'importe quel mot trouvé dans la recette, comme les ingrédients. L'utilisateur peut également envoyer un courriel (avec ou sans pièce jointe) au propriétaire du site. Les formulaires doivent aussi être validés...</br>

Pour ce projet, je voulais en savoir plus sur les bases de données PHP et MySQL afin de produire une application Web complète. La base de ce projet provient du cours OpenClassrooms [Concevez votre site web avec PHP et MySQL](https://openclassrooms.com/en/courses/918836-concevez-votre-site-web-avec-php-et-mysql) *(en français)*. J'ai utilisé comme point de départ...</br>
Comme le cours n'explique pas tout, je me suis retrouvé à compléter la fonctionnalité pour pouvoir réellement envoyer une pièce jointe ainsi que la validation de formulaire, par exemple, qui ne sont pas abordés dans le cours.</br>
Le site n'est pas très inspirant (encore un autre site de recettes, pourquoi Openclassrooms est-il obsédé par les sites de recettes ?) et le style css est simple, mais l'idée derrière ce projet était de découvrir de nouveaux langages de programmation et non de produire une application prête à la production.

## Fonctionnalités
- [x] Créer/détruire un compte
- [x] Connexion / Déconnexion
- [x] Page de visualisation des recettes
- [x] Créer/mettre à jour/supprimer une recette
- [x] Téléchargement/mise à jour d'une image
- [x] Page "Contactez-nous"  
- [x] Validation du formulaire : vérification de la validité de la saisie et du mot de passe, vérification de l'existence d'un utilisateur, etc.
- [x] Téléchargement de fichiers, vérification et envoi par e-mail
- [x] Recherche de recettes

## Compétences
- [x] Mise en place de l'environnement frontal pertinent
- [x] Développement d'une application web dynamique en PHP
- [x] Développement d'une application Web à l'aide de la base de données MySQL
- [x] Gestion des événements du site avec PHP

# Installation *(français)*

## Conditions préalables

- [MAMP](https://www.mamp.info/en/downloads/older-versions/) Version 4.2.0
- [Code Visual Studio](https://code.visualstudio.com/) ou un autre IDE de votre choix


## Installer et exécuter le projet


- Téléchargez et installez MAMP :<br/>

Une fois téléchargé, installez-le. Il y a quelques options. Si on vous propose d'installer MAMP Pro, dites non, car c'est un programme payant et vous n'en aurez pas besoin. MAMP seul suffit.<br/>

Clonez ce référentiel sur votre ordinateur et placez-le dans<br/>

- [x] C:MAMP/htdocs sous Windows 
- [x] /Applications/MAMP/htdocs sous Mac.<br/>

Remarque : Si vous décidez de conserver le projet ailleurs, n'oubliez pas de modifier la racine du document serveur : <br/>
Pour ce faire : une fois que vous avez démarré MAMP, cliquez sur MAMP > Préférences > Serveur Web et modifiez la racine du document dans le dossier approprié<br/>

Démarrez MAMP qui démarre Apache et MySQL (vous devrez peut-être cliquer sur "Démarrer les serveurs"). Vous devriez voir les petites LED vertes en haut à droite de la fenêtre. Le démarrage de ces programmes peut prendre un certain temps.<br/>

Si une fenêtre apparaît vous indiquant que le pare-feu bloque Apache ou MySQL, cliquez sur "Autoriser l'accès" (c'est normal).<br/>

Cliquez sur MAMP > Préférences > PHP et changez la version Standard en 7.3.7<br/>


- Installer la base de données

Lorsque MAMP a lancé avec succès Apache et MySQL, cliquez sur le bouton "Ouvrir la page de démarrage Web" au milieu, ce qui vous permet d'ouvrir la page d'accueil de MAMP dans votre navigateur.<br/>
Cliquez sur Outils > phpMyAdmin : Cela ouvrira une nouvelle fenêtre, vous donnant accès à la base de données MYSQL. Vous pouvez importer le fichier de base de données ``we_love_food.sql` que vous trouverez dans le dossier `SQL` pour configurer la base de données pour ce projet.

- Modifiez les valeurs suivantes dans votre fichier `php.ini` :<br/>

Assurez-vous de modifier le bon fichier php.ini, par exemple : C:\MAMP\conf\php7.3.7<br/>
upload_max_filesize = 5M (au lieu de 2M)<br/>
post_max_size = 8M (au lieu de 8M)<br/>
max_execution_time = 60 (au lieu de 30)<br/>
max_input_time = 120 (au lieu de 60)<br/>
memory_limit = 128M (Changement de 128M)<br/>

- Modifiez les valeurs suivantes dans le fichier `variables.php` :<br/>

Vous devrez ajouter vos propres détails pour le serveur SMTP : <br/>

  $SMTPUsername = 'votreemail@gmail.com' ;        // Nom d'utilisateur SMTP <br/>
  $SMTPPassword = 'generatedByGmail' ;            // Mot de passe SMTP <br/>
  $recipientEmail = 'votreemail@gmail.com'<br/>

En utilisant Gmail, vous devrez lire leur documentation pour obtenir un "mot de passe d'application" généré par Google. Comme j'ai utilisé Gmail, les paramètres du serveur sont comme ci-dessous (voir `contact_post.php`), mais si vous utilisez une adresse e-mail différente, vous devrez également modifier ici..<br/>

  // Paramètres du serveur <br/>
  $mail->isSMTP();                            // Définir le mailer pour utiliser SMTP <br/>
  $mail->Hôte = 'smtp.gmail.com' ;            // Spécifiez les serveurs SMTP principal et de secours <br/>
  $mail->SMTPAuth = true ;                    // Activer l'authentification SMTP <br/>
  $mail->Nom d'utilisateur = $SMTPUsername ;  // Nom d'utilisateur SMTP <br/>
  $mail->Mot de passe = $SMTPPassword ;       // Mot de passe SMTP <br/>
  $mail->SMTPSecure = 'ssl';                  // Activer le cryptage TLS, `ssl` également accepté <br/>
  $mail->Port = 465 ;                         // Port TCP auquel se connecter <br/>

- Exécutez l'API :

Si vous avez tout fait correctement, lorsque vous cliquez sur "Mon site Web" sur la page d'accueil MAMP de votre navigateur, le projet devrait s'ouvrir.</br>

## Remarques

J'ai utilisé [InfinityFree](https://www.infinityfree.net/) pour héberger ce projet.
Si vous utilisez un hébergement gratuit avec votre propre domaine ou un sous-domaine, vous souhaiterez que votre site Web fonctionne via HTTPS (SSL). Heureusement, InfinityFree fournit tous les outils dont vous avez besoin pour y parvenir. Veuillez vous référer à leurs notes sur l'obtention d'un SSL gratuit et vous devrez ensuite ajouter le code suivant à votre fichier `.htaccess` : <br/>
Ce code n'est PAS dans mon fichier `.htaccess` (dans la version dans mon repo) donc vous pouvez utiliser le projet sur localhost.<br/>

RewriteEngine On<br/>
RewriteCond %{HTTP:X-Forwarded-Proto} !https<br/>
RewriteCond %{HTTPS} off<br/>
RewriteCond %{HTTP:CF-Visitor} !{"scheme":"https"}<br/>
RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]<br/>

Voici les deux pages Web que j'ai utilisées pour faire cela :<br/>

- [Comment obtenir le SSL gratuit (HTTPS) sur InfinityFree](https://forum.infinityfree.net/t/how-to-get-free-ssl-https-on-infinityfree/49323)

- [Comment forcer tout le trafic vers HTTPS](https://forum.infinityfree.net/t/how-to-force-all-traffic-to-https/49322)


